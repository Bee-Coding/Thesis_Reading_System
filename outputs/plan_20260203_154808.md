{
  "plan_id": "GOALFLOW_E2E_20250203_001_DI",
  "created_at": "2025-02-03T10:30:00Z",
  "meta": {
    "focus": "GoalFlow: 基于目标点引导和Flow Matching的端到端自动驾驶多模态轨迹生成方法。重点分析其目标点构造与评分机制、Flow Matching在轨迹生成中的应用，以及该方法相比传统扩散模型如何解决轨迹发散和质量下降问题。",
    "mode": "Deep_Internalization",
    "paper_source": "用户提供的摘要与章节标题，但缺少完整PDF链接。此为关键风险点。",
    "code_source": "未提供。需在计划中增加‘源码寻找’任务。",
    "priority": 1,
    "risk_level": "medium_high (因缺少完整论文和代码源)"
  },
  "context": {
    "atlas_snapshot": {
      "total_atoms": 1256,
      "domain_coverage": ["planning", "control", "perception", "end_to_end"],
      "recent_contributions": ["MATH_VAD_ATTENTION_01", "CODE_DETR_QUERY_01"],
      "potential_overlap_topics": ["multimodal_trajectory_prediction", "diffusion_models_in_AD", "goal_conditioned_planning"]
    },
    "pre_check_result": {
      "paper_accessible": false,
      "code_repo_cloned": false,
      "domain_overlap": 0.65,
      "risk_assessment": "核心风险：用户未提供完整论文PDF或有效链接，无法进行基于物理真实的深度内化。必须将‘获取完整资料’设为计划前置条件与质量门控。"
    }
  },
  "task_graph": {
    "stages": [
      {
        "stage_id": "S0",
        "stage_name": "前置条件验证与资料获取",
        "execution_mode": "sequential",
        "description": "此阶段为安全熔断阶段。由于缺少完整论文，深度内化无法进行。必须首先解决资料问题。",
        "tasks": [
          {
            "task_id": "TASK_ORCH_REQUEST_SOURCE_001",
            "agent": "E2E-Learning-Orchestrator",
            "input_spec": {
              "sources": [
                {
                  "type": "user_prompt",
                  "content": "已接收摘要，但无法定位完整论文。"
                }
              ]
            },
            "output_spec": {
              "atom_type": null,
              "quality_threshold": null,
              "expected_count": "1",
              "deliverable": "向用户清晰说明当前阻塞状态，并明确请求提供完整论文PDF或可访问的链接（如ArXiv编号）。同时，询问是否有已知的开源代码仓库（如GitHub链接）。"
            },
            "timeout_seconds": 300,
            "priority": 1,
            "dependencies": []
          }
        ]
      },
      {
        "stage_id": "S1",
        "stage_name": "并行核心分析",
        "execution_mode": "parallel",
        "description": "在成功获取完整论文和/或代码后，并行启动三个专项分析，从理论、实现、应用三个维度内化GoalFlow。",
        "tasks": [
          {
            "task_id": "TASK_SCHOLAR_GOALFLOW_001",
            "agent": "Scholar_Internalizer",
            "input_spec": {
              "sources": [
                {
                  "type": "paper",
                  "paper_id": "[待用户提供]",
                  "focus_sections": ["Method - Goal Point Construction", "Method - Generation Model (Flow Matching)", "Method - Scoring Mechanism"]
                }
              ],
              "delta_analysis_target": ["/atoms/math_ops/目录下关于轨迹生成、扩散模型、条件概率的现有资产"]
            },
            "output_spec": {
              "atom_type": "Math_Atom",
              "quality_threshold": "A",
              "expected_count": "4-6",
              "deliverable": "产出原子卡片，例如：1. GoalFlow整体生成范式数学描述；2. 目标点候选集构建与基于场景的评分函数(Eq. x)；3. Flow Matching应用于轨迹生成的条件概率流推导(Eq. y)；4. 最终轨迹选择评分机制(Eq. z)。所有公式必须锚定页码或公式编号。"
            },
            "timeout_seconds": 1200,
            "priority": 1,
            "dependencies": ["TASK_ORCH_REQUEST_SOURCE_001(SUCCESS)"]
          },
          {
            "task_id": "TASK_CODE_GOALFLOW_001",
            "agent": "Code_Implementor",
            "input_spec": {
              "sources": [
                {
                  "type": "code_repo",
                  "repo_url": "[待用户提供或通过检索确定]"
                },
                {
                  "type": "paper",
                  "paper_id": "[待用户提供]",
                  "focus_sections": ["Method"]
                }
              ]
            },
            "output_spec": {
              "atom_type": "Code_Atom",
              "quality_threshold": "B+",
              "expected_count": "3-5",
              "deliverable": "产出原子卡片，例如：1. 目标点网络（Goal Point Construction Network）的核心实现（文件路径+行号）；2. Flow Matching模型（Generation Model）的前向传播与训练循环关键代码；3. 评分机制（Scoring Mechanism）的集成实现。包含TRT/部署友好性分析。"
            },
            "timeout_seconds": 1500,
            "priority": 1,
            "dependencies": ["TASK_ORCH_REQUEST_SOURCE_001(SUCCESS)"]
          },
          {
            "task_id": "TASK_VALIDATOR_GOALFLOW_001",
            "agent": "Scenario_Validator",
            "input_spec": {
              "sources": [
                {
                  "type": "paper",
                  "paper_id": "[待用户提供]",
                  "focus_sections": ["Experiments", "Abstract中的问题描述"]
                }
              ],
              "existing_scenarios": ["/atoms/scenarios/目录下关于轨迹发散、多模态冲突、规控失效的案例"]
            },
            "output_spec": {
              "atom_type": "Scenario_Atom",
              "quality_threshold": "B",
              "expected_count": "2-3",
              "deliverable": "产出原子卡片，例如：1. 场景：传统扩散模型在复杂路口产生的“轨迹发散”FMEA分析；2. 判据：如何量化评估GoalFlow提出的“目标点约束”对轨迹质量（合理性、模态清晰度）的提升（引用实验表格）；3. 风险：目标点评分机制失效的Corner Case假设（如传感器漏检导致的错误目标点）。"
            },
            "timeout_seconds": 900,
            "priority": 1,
            "dependencies": ["TASK_ORCH_REQUEST_SOURCE_001(SUCCESS)"]
          }
        ]
      },
      {
        "stage_id": "S2",
        "stage_name": "交叉验证与资产整合",
        "execution_mode": "sequential",
        "description": "汇集三方产出，进行一致性校验，并整合入库至知识库。",
        "tasks": [
          {
            "task_id": "TASK_ORCH_AUDIT_001",
            "agent": "E2E-Learning-Orchestrator",
            "input_spec": {
              "sources": [
                {
                  "type": "agent_output",
                  "output_from": ["TASK_SCHOLAR_GOALFLOW_001", "TASK_CODE_GOALFLOW_001", "TASK_VALIDATOR_GOALFLOW_001"]
                }
              ]
            },
            "output_spec": {
              "atom_type": "Audit_Report",
              "quality_threshold": null,
              "expected_count": "1",
              "deliverable": "真实性熔断审计报告。检查数学公式与代码实现是否逻辑一致（如Flow Matching的数学形式是否在代码中正确体现），验证所有引用锚点（页码、行号）的真实性。标记任何发现的矛盾或模糊点。"
            },
            "timeout_seconds": 600,
            "priority": 1,
            "dependencies": ["TASK_SCHOLAR_GOALFLOW_001(DONE)", "TASK_CODE_GOALFLOW_001(DONE)", "TASK_VALIDATOR_GOALFLOW_001(DONE)"]
          },
          {
            "task_id": "TASK_VAULT_INTEGRATE_001",
            "agent": "Knowledge_Vault",
            "input_spec": {
              "sources": [
                {
                  "type": "agent_output",
                  "output_from": ["TASK_SCHOLAR_GOALFLOW_001", "TASK_CODE_GOALFLOW_001", "TASK_VALIDATOR_GOALFLOW_001"]
                },
                {
                  "type": "system_memory",
                  "path": "/manifests/algorithm_atlas.md"
                }
              ]
            },
            "output_spec": {
              "atom_type": "Integration_Report",
              "quality_threshold": null,
              "expected_count": "1",
              "deliverable": "资产入库报告。将本次研读产出的所有标准原子卡片，根据其功能分类存储到`/atoms/math_ops/`, `/atoms/code_snippets/`, `/atoms/scenarios/`目录下。更新`/manifests/algorithm_atlas.md`，在“Trajectory Generation / End-to-End Planning”领域下记录GoalFlow的贡献与链接。"
            },
            "timeout_seconds": 600,
            "priority": 1,
            "dependencies": ["TASK_ORCH_AUDIT_001(DONE)"]
          }
        ]
      },
      {
        "stage_id": "S3",
        "stage_name": "战略评估与交付",
        "execution_mode": "sequential",
        "description": "基于内化成果，给出最终的量产价值评估与决策建议。",
        "tasks": [
          {
            "task_id": "TASK_CRITIC_ASSESS_001",
            "agent": "Strategic_Critic",
            "input_spec": {
              "sources": [
                {
                  "type": "agent_output",
                  "output_from": ["TASK_SCHOLAR_GOALFLOW_001", "TASK_CODE_GOALFLOW_001", "TASK_VALIDATOR_GOALFLOW_001", "TASK_VAULT_INTEGRATE_001"]
                },
                {
                  "type": "paper",
                  "paper_id": "[待用户提供]",
                  "focus_sections": ["Experiments"]
                }
              ]
            },
            "output_spec": {
              "atom_type": "Strategic_Assessment",
              "quality_threshold": null,
              "expected_count": "1",
              "deliverable": "量产审计报告。从计算开销（Flow Matching vs Diffusion）、模块可靠性（目标点评分网络）、场景泛化性（实验指标S↑）、与现有规控栈集成难度等维度，评估GoalFlow的工程化潜力。"
            },
            "timeout_seconds": 600,
            "priority": 1,
            "dependencies": ["TASK_VAULT_INTEGRATE_001(DONE)"]
          },
          {
            "task_id": "TASK_ORCH_FINALIZE_001",
            "agent": "E2E-Learning-Orchestrator",
            "input_spec": {
              "sources": [
                {
                  "type": "agent_output",
                  "output_from": ["TASK_CRITIC_ASSESS_001", "TASK_VAULT_INTEGRATE_001", "TASK_ORCH_AUDIT_001"]
                }
              ]
            },
            "output_spec": {
              "atom_type": "Final_Decision_Package",
              "quality_threshold": null,
              "expected_count": "1",
              "deliverable": "最终决策包。汇总：1. 本次深度内化的核心收获（资产清单）；2. Strategic_Critic的量产审计意见；3. 明确的【Go/Watch/Skip】建议及理由。输出为完整的研读报告。"
            },
            "timeout_seconds": 300,
            "priority": 1,
            "dependencies": ["TASK_CRITIC_ASSESS_001(DONE)"]
          }
        ]
      }
    ]
  },
  "quality_gates": {
    "pre_execution": [
      {
        "gate_id": "QG_PRE_SOURCE_ACCESS_01",
        "gate_type": "pre_execution",
        "task_id": "ALL_TASKS_IN_S1",
        "checks": [
          {
            "check_id": "CHECK_FULL_PAPER_ACCESS",
            "check_type": "source_accessibility",
            "target": "paper_source",
            "condition": "user_provided_valid_full_paper_link_or_pdf == true",
            "error_code": "E001",
            "severity": "critical",
            "error_message": "深度内化模式必须基于完整的论文原文。当前仅凭摘要无法进行，继续执行将导致算法幻觉。"
          }
        ],
        "failure_action": "block_and_escalate",
        "escalation_target": "user"
      }
    ],
    "post_execution": [
      {
        "gate_id": "QG_POST_SCHOLAR_01",
        "gate_type": "post_execution",
        "task_id": "TASK_SCHOLAR_GOALFLOW_001",
        "checks": [
          {
            "check_id": "CHECK_MATH_ATOM_ANCHOR",
            "check_type": "output_validation",
            "target": "Math_Atom.anchor",
            "condition": "all_anchors_exist_and_are_non_placeholder",
            "error_code": "E101",
            "severity": "high"
          }
        ],
        "failure_action": "retry_with_focus"
      }
    ],
    "final_integration": [
      {
        "gate_id": "QG_FINAL_ATOM_STORAGE",
        "gate_type": "final_integration",
        "task_id": "TASK_VAULT_INTEGRATE_001",
        "checks": [
          {
            "check_id": "CHECK_ATOMS_STORED",
            "check_type": "system_state",
            "target": "/atoms/ directory",
            "condition": "new_atoms_count >= expected_min_count",
            "error_code": "E201",
            "severity": "high"
          },
          {
            "check_id": "CHECK_ATLAS_UPDATED",
            "check_type": "system_state",
           